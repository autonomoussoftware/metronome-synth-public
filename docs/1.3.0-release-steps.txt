# Mainnet

1. Run deployment script

    ```sh
    npx hardhat deploy --network mainnet --gasprice <gas price in wei>
    ```

    This will build multi-sig batch transaction with upgrades and a few config (setters)

1. Verify contracts

    ```sh
    npm run verify -- --network mainnet
    ```

1. Update upgraders mapping with the new versions

    Change `deploy/helpers/index.ts` (follow green console outputs guidance)

1. Run deployment script again

    ```sh
    npx hardhat deploy --network mainnet --gasprice <gas price in wei>
    ```

    This will build multi-sig batch transaction with config calls that should be run against new code/abi (e.g. new cross-chain setters)
    Note: This must be executed after the first batch transaction

1. Run create-release task

    ```sh
    npx hardhat create-release --release 1.3.0 --network mainnet
    ```


# Optimism

1. Undo upgraders mapping change

    Back the upgraders' contracts mapping to later state (i.e. sync with OP prod versions)

1. Run deployment script

    ```sh
    npx hardhat deploy --network optimism --gasprice <gas price in wei>
    ```

    This will build multi-sig batch transaction with upgrades and a few config (setters)

1. Verify contracts

    ```sh
    npm run verify -- --network optimism
    ```

1. Update upgraders mapping with the new versions

    Change `deploy/helpers/index.ts` (follow green console outputs guidance)

1. Run deployment script again

    ```sh
    npx hardhat deploy --network optimism --gasprice <gas price in wei>
    ```

    This will build multi-sig batch transaction with config calls that should be run against new code/abi (e.g. new cross-chain setters)
    Note: This must be executed after the first batch transaction

1. Run create-release task

    ```sh
    npx hardhat create-release --release 1.3.0 --network optimism
    ```


# After both upgrades


1. Fill commented setup from deployment scripts related to counter-party addresses (See `CrossChainDispatcher` and `ProxyOFT` deployment scripts)

1. Run deployment scripts again
